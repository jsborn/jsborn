(function(l){JSB.extendPlugin("dom",JSB.cls("jsborn/plugins/dom",{extend:"jsborn/plugins/model",initialize:function(b){var a=this;a.SUPER(a);a.PLUG_DOM={str_root:"body",tag:["INPUT","SELECT"],nodes:[]};a.parent=b?b:a;a.parent.addEventListener("destroy",function(){for(var b=0;b<a.PLUG_DOM.nodes.length;b++)a.PLUG_DOM.nodes[b].destroy()})},registerData:function(){var b=this;this.select().find("[jsb-data]").filter(function(){return!$(this).parentsUntil(b.select(),"[jsb-cls]").length}).each(function(a,
g){var d=jQuery(this),e=d.attr("jsb-data"),c=d.attr("jsb-data-event"),c=c?c.split(","):[],f=e.split(":"),e=f[0],k=f[1],h,f=b.PLUG_DOM;0>=c.length&&c.push("modify");h=-1==jQuery.inArray(d[0].tagName,f.tag)?"html":"val";for(a=0;a<c.length;a++)b.getModel(e)&&b.getModel(e).addEventListener("model-"+c[a],function(a,b,c){a=JSB.core.model.getObjKey(c,k);if(!1!==a)d[h](a)})})},registerClass:function(){var b=this;this.select().find("[jsb-cls]").filter(function(){return!$(this).parentsUntil(b.select(),"[jsb-cls]").length}).each(function(a,
g){var d=jQuery(this).attr("jsb-cls"),d=JSB.create(d);b.PLUG_DOM.nodes.push(d);jQuery(b).triggerHandler("cls.controller-create",[d,g])})},registerEvent:function(b){var a=this;this.select().find("[jsb-event]").filter(function(){return!$(this).parentsUntil(a.select(),"[jsb-cls]").length}).each(function(b,d){var e=jQuery(this).attr("jsb-event").split(":"),c=e[0],f=a.parent[e[1]];jQuery(this)[JSB.event.off](c)[JSB.event.on](c,{scope:a.parent},function(a){jQuery.isFunction(f)?f.apply(this,arguments):console.log("DOM IS NOT DEFINE EVENT CallBack",
b)})})},select:function(b){var a=this.PLUG_DOM.str_root;if(b)return jQuery(a).find(b);a||(a="body");return jQuery(a)},setRoot:function(b){this.PLUG_DOM.str_root=b;return this.PLUG_DOM.str_root},getRoot:function(){return this.PLUG_DOM.str_root}}))})(window);
